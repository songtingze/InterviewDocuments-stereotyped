## 1.计算机网络的各层协议及作用？

计算机网络体系可以大致分为一下三种，OSI七层模型、TCP/IP四层模型和五层模型。

- OSI七层模型：应用层-表示层-会话层-运输层-网络层-链路层-物理层。

  七层网络体系结构各层的主要功能：

  - 应用层：为应用程序提供交互服务。在互联网中的应用层协议很多，如域名系统DNS，支持万维网应用的HTTP协议，支持电子邮件的SMTP协议等。

  - 表示层：主要负责数据格式的转换，如加密解密、转换翻译、压缩解压缩等。

  - 会话层：负责在网络中的两节点之间建立、维持和终止通信，如服务器验证用户登录便是由会话层完成的。

  - 运输层：有时也译为传输层，向主机进程提供通用的数据传输服务。该层主要有以下两种协议：
    - TCP：提供面向连接的、可靠的数据传输服务；
    - UDP：提供无连接的、尽最大努力的数据传输服务，但不保证数据传输的可靠性。

  - 网络层：选择合适的路由和交换结点，确保数据及时传送。主要包括IP协议。

  - 数据链路层：数据链路层通常简称为链路层。将⽹络层传下来的IP数据包组装成帧，并再相邻节点的链路上传送帧。

- TCP/IP四层模型：应用层（各种应用层协议，如TELNET，FTP，SMTP等）-运输层（TCP或UDP）-网络层IP-网络接口层。

- 五层模型：应用层-运输层-网络层-数据链路层-物理层。

## 2.为什么需要三次握⼿，⽽不是两次？

主要有三个原因：

- 防止已过期的连接请求报文突然又传送到服务器，因而产生错误和资源浪费。

​		在双方两次握手即可建立连接的情况下，假设客户端发送 A 报文段请求建立连接，由于网络原因造成 A 暂时无法到达服务器，服务器接收不到请求报文段就不会返回确认报文段。

​		客户端在长时间得不到应答的情况下重新发送请求报文段 B，这次 B 顺利到达服务器，服务器随即返回确认报文并进⼊ ESTABLISHED 状态，客户端在收到确认报文后也进⼊ESTABLISHED 状态，双方建立连接并传输数据，之后正常断开连接。

​		此时姗姗来迟的 A 报文段才到达服务器，服务器随即返回确认报文并进⼊ ESTABLISHED 状态，但是已经进⼊ CLOSED 状态的客户端无法再接受确认报文段，更无法进入ESTABLISHED 状态，这将导致服务器长时间单方面等待，造成资源浪费。

- 三次握手才能让双方均确认自己和对方的发送和接收能力都正常。

​		第一次握手：客户端只是发送处请求报文段，什么都无法确认，而服务器可以确认自己的接收能力和对方的发送能力正常；

​		第二次握手：客户端可以确认自己发送能力和接收能力正常，对方发送能力和接收能力正常；

​		第三次握手：服务器可以确认自己发送能力和接收能力正常，对方发送能力和接收能力正常；

​		可见三次握手才能让双方都确认自己和对方的发送和接收能力全部正常，这样就可以愉快地进行通信了。

- 告知对方自己的初始序号值，并确认收到对方的初始序号值。

​		TCP 实现了可靠的数据传输，原因之一就是 TCP 报文段中维护了序号字段和确认序号字段，通过这两个字段双方都可以知道在自己发出的数据中，哪些是已经被对方确认接收的。这两个字段的值会在初始序号值得基础递增，如果是两次握手，只有发起方的初始序号可以得到确认，⽽另一方的初始序号则得不到确认。

## 3.为什么要三次握手，而不是四次？

​		因为三次握手已经可以确认双方的发送接收能力正常，双方都知道彼此已经准备好，而且也可以完成对双方初始序号值得确认，也就无需再第四次握手了。

第一次握手：服务端确认“自己收、客户端发”报文功能正常。

第⼆次握手：客户端确认“自己发、自己收、服务端收、客户端发”报文功能正常，客户端认为连接已建立。

第三次握手：服务端确认“自己发、客户端收”报文功能正常，此时双方均建⽴连接，可以正常通信。

